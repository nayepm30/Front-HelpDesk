{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import\"bootstrap/dist/css/bootstrap.min.css\";import\"bootstrap-icons/font/bootstrap-icons.css\";import\"../usuarios/Usuarios.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Roles(){const[roles,setRoles]=useState([]);const[cargando,setCargando]=useState(true);const[error,setError]=useState(\"\");const[usuarios,setUsuarios]=useState([]);const[rolSeleccionado,setRolSeleccionado]=useState(null);const[cargandoUsuarios,setCargandoUsuarios]=useState(false);const[mostrandoModalUsuarios,setMostrandoModalUsuarios]=useState(false);useEffect(()=>{const obtenerRoles=async()=>{try{const respuesta=await fetch(\"http://localhost:3001/web/roles\");if(!respuesta.ok)throw new Error(\"Error al obtener roles\");const datos=await respuesta.json();setRoles(datos);}catch(err){setError(err.message);}finally{setCargando(false);}};obtenerRoles();},[]);const verUsuarios=async rol=>{setRolSeleccionado(rol);setMostrandoModalUsuarios(true);setCargandoUsuarios(true);try{const res=await fetch(\"http://localhost:3001/web/rolesUsuarios?id_rol=\".concat(rol.id_rol));if(!res.ok)throw new Error(\"Error al obtener usuarios\");const datos=await res.json();setUsuarios(datos);}catch(err){console.error(err);setUsuarios([]);}finally{setCargandoUsuarios(false);}};const cerrarModalUsuarios=()=>{setMostrandoModalUsuarios(false);setRolSeleccionado(null);setUsuarios([]);};if(cargando)return/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-5\",children:\"Cargando roles...\"});if(error)return/*#__PURE__*/_jsx(\"p\",{className:\"text-danger text-center mt-5\",children:error});return/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-4 usuarios-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-dark\",children:\"Lista de Roles\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive shadow-sm rounded\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-hover align-middle\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-danger\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:roles.map(rol=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:rol.id_rol}),/*#__PURE__*/_jsx(\"td\",{children:rol.nombre_rol}),/*#__PURE__*/_jsx(\"td\",{children:rol.descripcion_rol}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline-primary btn-sm\",onClick:()=>verUsuarios(rol),children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-people\"}),\" Usuarios\"]})})]},rol.id_rol))})]})}),mostrandoModalUsuarios&&/*#__PURE__*/_jsx(\"div\",{className:\"custom-modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom-modal-content\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Usuarios con el rol: \",rolSeleccionado===null||rolSeleccionado===void 0?void 0:rolSeleccionado.nombre_rol]}),cargandoUsuarios?/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-3\",children:\"Cargando usuarios...\"}):usuarios.length>0?/*#__PURE__*/_jsx(\"ul\",{children:usuarios.map(u=>/*#__PURE__*/_jsx(\"li\",{children:u.nombre_usuario||\"(Sin nombre registrado)\"},u.id_usuario))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-3\",children:\"No hay usuarios asignados a este rol.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end mt-3\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:cerrarModalUsuarios,children:\"Cerrar\"})})]})})]});}export default Roles;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Roles","roles","setRoles","cargando","setCargando","error","setError","usuarios","setUsuarios","rolSeleccionado","setRolSeleccionado","cargandoUsuarios","setCargandoUsuarios","mostrandoModalUsuarios","setMostrandoModalUsuarios","obtenerRoles","respuesta","fetch","ok","Error","datos","json","err","message","verUsuarios","rol","res","concat","id_rol","console","cerrarModalUsuarios","className","children","map","nombre_rol","descripcion_rol","onClick","length","u","nombre_usuario","id_usuario"],"sources":["C:/Users/nayep/Desktop/Proyecto_10mo-react/React/help-desk/src/components/modulos/roles/Roles.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"bootstrap-icons/font/bootstrap-icons.css\";\nimport \"../usuarios/Usuarios.css\"; \n\nfunction Roles() {\n  const [roles, setRoles] = useState([]);\n  const [cargando, setCargando] = useState(true);\n  const [error, setError] = useState(\"\");\n\n  const [usuarios, setUsuarios] = useState([]);\n  const [rolSeleccionado, setRolSeleccionado] = useState(null);\n  const [cargandoUsuarios, setCargandoUsuarios] = useState(false);\n  const [mostrandoModalUsuarios, setMostrandoModalUsuarios] = useState(false);\n\n  useEffect(() => {\n    const obtenerRoles = async () => {\n      try {\n        const respuesta = await fetch(\"http://localhost:3001/web/roles\");\n        if (!respuesta.ok) throw new Error(\"Error al obtener roles\");\n        const datos = await respuesta.json();\n        setRoles(datos);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setCargando(false);\n      }\n    };\n    obtenerRoles();\n  }, []);\n\n  const verUsuarios = async (rol) => {\n    setRolSeleccionado(rol);\n    setMostrandoModalUsuarios(true);\n    setCargandoUsuarios(true);\n\n    try {\n      const res = await fetch(`http://localhost:3001/web/rolesUsuarios?id_rol=${rol.id_rol}`);\n      if (!res.ok) throw new Error(\"Error al obtener usuarios\");\n      const datos = await res.json();\n      setUsuarios(datos);\n    } catch (err) {\n      console.error(err);\n      setUsuarios([]);\n    } finally {\n      setCargandoUsuarios(false);\n    }\n  };\n\n  const cerrarModalUsuarios = () => {\n    setMostrandoModalUsuarios(false);\n    setRolSeleccionado(null);\n    setUsuarios([]);\n  };\n\n  if (cargando) return <p className=\"text-center mt-5\">Cargando roles...</p>;\n  if (error) return <p className=\"text-danger text-center mt-5\">{error}</p>;\n\n  return (\n    <div className=\"container mt-4 usuarios-container\">\n      <div className=\"d-flex justify-content-between align-items-center mb-3\">\n        <h2 className=\"text-dark\">Lista de Roles</h2>\n      </div>\n\n      <div className=\"table-responsive shadow-sm rounded\">\n        <table className=\"table table-hover align-middle\">\n          <thead className=\"table-danger\">\n            <tr>\n              <th>ID</th>\n              <th>Nombre</th>\n              <th>Descripci√≥n</th>\n              <th>Acciones</th>\n            </tr>\n          </thead>\n\n          <tbody>\n            {roles.map((rol) => (\n              <tr key={rol.id_rol}>\n                <td>{rol.id_rol}</td>\n                <td>{rol.nombre_rol}</td>\n                <td>{rol.descripcion_rol}</td>\n                <td>\n                  <button\n                    className=\"btn btn-outline-primary btn-sm\"\n                    onClick={() => verUsuarios(rol)}\n                  >\n                    <i className=\"bi bi-people\"></i> Usuarios\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {/* --- Modal Usuarios Asignados --- */}\n      {mostrandoModalUsuarios && (\n        <div className=\"custom-modal\">\n          <div className=\"custom-modal-content\">\n            <h4>Usuarios con el rol: {rolSeleccionado?.nombre_rol}</h4>\n\n            {cargandoUsuarios ? (\n              <p className=\"text-center mt-3\">Cargando usuarios...</p>\n            ) : usuarios.length > 0 ? (\n              <ul>\n                {usuarios.map((u) => (\n                  <li key={u.id_usuario}>\n                    {u.nombre_usuario || \"(Sin nombre registrado)\"}\n                  </li>\n                ))}\n              </ul>\n            ) : (\n              <p className=\"text-center mt-3\">No hay usuarios asignados a este rol.</p>\n            )}\n\n            <div className=\"d-flex justify-content-end mt-3\">\n              <button className=\"btn btn-secondary\" onClick={cerrarModalUsuarios}>\n                Cerrar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Roles;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}